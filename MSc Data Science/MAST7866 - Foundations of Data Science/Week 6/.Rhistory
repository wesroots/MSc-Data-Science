"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3)
)
)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3)
"| hat{y} = ",
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3)
"| hat{y} = "
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3)
"| haty = "
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| haty = "
)
)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| hat{y{} = "
)
)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| hat{y = "
)
)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| hat{y} = "
)
)
q3_plot <-
ggplot(diamonds, aes(y = Price, x = Size)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
# ylim(0, 1100) +
# xlim(0,0.4) +
labs(
x = "Size (carats)",
y = "Price (USD)",
title = "Scatterplot of diamond price vs size",
subtitle = paste(
"r =", round(cor(diamonds$Price, diamonds$Size),3),
"| R squared = ", round(cor(diamonds$Price, diamonds$Size)^2,3),
"| y-hat = ", round(coeffs[2],2), "size + ", round(coeffs[1],2)
)
)
q3_plot
ggsave("PC Sessions/Output/diamond_plot.png", plot = q3_plot)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = "
)
)
# Q3.
# (a) Effect on BP of increasing salt by 1g
summary(fit_salt)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = "
)
)
coeffs_q2 = lm(BP ~ salt, data = saltBP)
coeffs_q2
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", coeffs_q2
)
)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", coeffs_q2[1]
)
)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", coeffs_q2[1]
)
)
# Q3
coeffs
coeffs_q2
coeffs_q2
coeffs_q2 <- lm(BP ~ salt, data = saltBP)
coeffs_q2
coeffs_q2
coeffs_q2 <- lm(BP ~ salt, data = saltBP)
coeffs_q2
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", coeffs_q2[1]
)
)
# Q3
coeffs
model_q2 <- lm(BP ~ salt, data = saltBP)
coeffs_q2 <- coef(model_q2)
coeffs_q2
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", coeffs_q2[1]
)
)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", round(coeffs_q2[1],2)
)
)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", round(coeffs_q2[1],2) "salt + " round(coeffs_q2[2],2)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", round(coeffs_q2[1],2), "salt + ", round(coeffs_q2[2],2)
)
)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", round(coeffs_q2[1],2), "salt + ", round(coeffs_q2[2],3)
)
)
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", round(coeffs_q2[1],3), "salt + ", round(coeffs_q2[2],3)
)
)
q3_plot <-
ggplot(diamonds, aes(y = Price, x = Size)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
# ylim(0, 1100) +
# xlim(0,0.4) +
labs(
x = "Size (carats)",
y = "Price (USD)",
title = "Scatterplot of diamond price vs size",
subtitle = paste(
"r =", round(cor(diamonds$Price, diamonds$Size),3),
"| R squared = ", round(cor(diamonds$Price, diamonds$Size)^2,3),
"| y-hat = ", round(coeffs[2],2), "size + ", round(coeffs[1],2)
)
)
q3_plot
q3_plot <-
ggplot(diamonds, aes(y = Price, x = Size)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
# ylim(0, 1100) +
# xlim(0,0.4) +
labs(
x = "Size (carats)",
y = "Price (USD)",
title = "Scatterplot of diamond price vs size",
subtitle = paste(
"r =", round(cor(diamonds$Price, diamonds$Size),3),
"| R squared = ", round(cor(diamonds$Price, diamonds$Size)^2,3),
"| y-hat = ", round(coeffs[2],3), "size + ", round(coeffs[1],3)
)
)
q3_plot
ggsave("PC Sessions/Output/diamond_plot.png", plot = q3_plot)
q2_plot <-
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", round(coeffs_q2[1],3), "salt + ", round(coeffs_q2[2],3)
)
)
q2_plot
ggsave("PC Sessions/Data/saltBP_plot.png")
ggsave("PC Sessions/Output/saltBP_plot.png")
q2_plot <-
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="red") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"| y-hat = ", round(coeffs_q2[1],3), "salt + ", round(coeffs_q2[2],3)
)
)
q2_plot
ggsave("PC Sessions/Output/saltBP_plot.png")
# --- 1. Production runs data ---
fit_production
# --- 1. Production runs data ---
par(mfrow = c(2,2))
ggplot(production, aes(x = RunSize, y = RunTime)) +
geom_point() +                                   # scatter points
geom_smooth(method = "lm", se = FALSE, color = "red") +  # regression line
labs(
x = "Run Size",
y = "Run Time",
title = "Scatterplot of Run Time against Run Size"
)
library(gridExtra)
# --- 1. Production runs data ---
grid.arrange(p1 + p2, col=2)
ggplot(production, aes(x = RunSize, y = RunTime)) +
geom_point() +                                   # scatter points
geom_smooth(method = "lm", se = FALSE, color = "red") +  # regression line
labs(
x = "Run Size",
y = "Run Time",
title = "Scatterplot of Run Time against Run Size"
)
# --- 1. Production runs data ---
grid.arrange(p1 + p2, ncol=2)
# --- 1. Production runs data ---
library(patchwork)
(q2_plot | q3_plot)
q3_plot
# --- 1. Production runs data ---
library(patchwork)
(q2_plot | q3_plot)
# --- 1. Production runs data ---
library(patchwork)
(q2_plot | q3_plot)
# --- 1. Production runs data ---
installed.packages(patchwork)
library(patchwork)
(q2_plot | q3_plot)
# --- 1. Production runs data ---
installed.packages("patchwork")
library(patchwork)
library("patchwork")
# --- 1. Production runs data ---
install.packages("patchwork")
library("patchwork")
(q2_plot | q3_plot)
q3_plot <-
ggplot(diamonds, aes(y = Price, x = Size)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="blue") +
# ylim(0, 1100) +
# xlim(0,0.4) +
labs(
x = "Size (carats)",
y = "Price (USD)",
title = "Scatterplot of diamond price vs size",
subtitle = paste(
"r =", round(cor(diamonds$Price, diamonds$Size),3),
"| R squared = ", round(cor(diamonds$Price, diamonds$Size)^2,3),
"\n| y-hat = ", round(coeffs[2],3), "size + ", round(coeffs[1],3)
)
)
q3_plot
ggsave("PC Sessions/Output/diamond_plot.png", plot = q3_plot)
q2_plot <-
ggplot(saltBP, aes(y = BP, x = salt)) +
geom_point(size = 2) +
geom_smooth(method="lm", col="red") +
labs(
y = "BP (mmHg)",
x = "Salt (grams/day)",
title = "Scatterplot of salt intake vs. BP",
subtitle = paste(
"r = ", round(cor(saltBP$BP, saltBP$salt),3),
"| R squared = ", round(cor(saltBP$BP, saltBP$salt)^2,3),
"\n| y-hat = ", round(coeffs_q2[1],3), "salt + ", round(coeffs_q2[2],3)
)
)
q2_plot
ggsave("PC Sessions/Output/saltBP_plot.png")
(q2_plot | q3_plot)
(q2_plot | q3_plot)
# --- 1. Production runs data ---
par(mfrow = c(2,2))
plot(fit_production)
# --- 2. The effect of salt on BP ---
plot(fit_salt)
plot(fit_production)
# --- 2. The effect of salt on BP ---
plot(fit_salt)
production_resid <- plot(fit_production)
# --- 2. The effect of salt on BP ---
# Q1
salt_resid <- plot(fit_salt)
# --- 3. Pricing diamond rings ---
production_resid
salt_resit
salt_resid
# --- 3. Pricing diamond rings ---
production_resid
production_resid <- plot(fit_production)
# --- 3. Pricing diamond rings ---
production_resid
plot(fit_production)
# --- 3. Pricing diamond rings ---
rm(production_resid)
# --- 3. Pricing diamond rings ---
rm(salt_resid)
# --- 2. The effect of salt on BP ---
# Q1
plot(fit_salt)
plot(fit_production)
# --- 4. Advertising residuals
adrevenue <- read.table("PC Sessions/Data/AdRevenue.csv")
# --- 4. Advertising residuals
adrevenue <- read_table("PC Sessions/Data/AdRevenue.csv")
# --- 4. Advertising residuals
adrevenue <- read.table("PC Sessions/Data/AdRevenue.csv", header=TRUE)
# --- 4. Advertising residuals
adrevenue <- read.table("PC Sessions/Data/AdRevenue.csv", header=TRUE)
# --- 4. Advertising residuals
adrevenue <- read.csv("PC Sessions/Data/AdRevenue.csv", header=TRUE)
fit_adrevenue <- lm(AdRevenue~Circulation, data=adrevenue)
fit_adrevenue
# Q2
log(Revenue)
# Q2
fit_adrevenue_log <- lm(log(AdRevenue) ~ log(Circulation), data = adrevenue)
plot(fit_adrevenue_log$residuals)
plot(fit_adrevenue_log$fitted.values, fit_adrevenue_log$residuals)
# --- 1. Production runs data ---
par(mfrow = c(2,2))
# Q2
fit_adrevenue_log <- lm(log(AdRevenue) ~ log(Circulation), data = adrevenue)
plot(fit_adrevenue_log$residuals)
plot(fit_adrevenue_log$fitted.values, fit_adrevenue_log$residuals)
plot(fit_production)
# --- 2. The effect of salt on BP ---
# Q1
plot(fit_salt)
# --- 1. Production runs data ---
par(mfrow = c(2,2))
plot(fit_production)
# --- 2. The effect of salt on BP ---
# Q1
plot(fit_salt)
plot(fit_adrevenue_log$residuals)
plot(fit_adrevenue_log$fitted.values, fit_adrevenue_log$residuals)
plot(adrevenue$Circulation, adrevenue$AdRevenue,
xlab = "")
plot(fit_adrevenue_log)
# --- 1. Production runs data ---
par(mfrow = c(2,2))
plot(fit_production)
# --- 2. The effect of salt on BP ---
# Q1
plot(fit_salt)
# --- 4. Advertising residuals
# Q1
adrevenue <- read.csv("PC Sessions/Data/AdRevenue.csv", header=TRUE)
fit_adrevenue <- lm(AdRevenue~Circulation, data=adrevenue)
# Q2
fit_adrevenue_log <- lm(log(AdRevenue) ~ log(Circulation), data = adrevenue)
plot(fit_adrevenue_log)
